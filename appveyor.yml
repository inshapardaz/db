version: 1.0.{build}
max_jobs: 1
image: Visual Studio 2019


environment:
  ConnectionStringTest:
    secure: xRPJOkFVcWlOPF0wlbbRsjmPXiDSnTjd03Q4aM6bI1hjzjjUsH4wxNSJRnuH3DT9Z3x+fGXmdVdgexKx/ghFpC6znjlEgoE8gL00q86zZ+xcE3piP/6IfH8YutYJ5+OdgOS027eYbt2Ao+LmoZyjy1bGEr3af8wr1NwJrhsHshuzlNrUIpLZ4rbjuMqfiNofNLACeTJ5pif6Z00v2pSRLyEz9QnemZdtwM+zKV9IURTB9UHJFPf36DeaaVU6LCCDMMUCbgVcr1R8rxTnl2UgXZKqX7Q33/Gb2A6VEf/bm7OaqWmr/xAKRzgvInnEcftT
  ConnectionString:
    secure: /QAHrKVU6z5bQ9+vnbYAk6uITnSYQQZP85hnKJXpXAB46mqR2xDA5o8KU7Ooz6abxLOpR3f13j04wAvKVoGwKgqruyU+Jlzlx1V6rL9/gGWz7nj8a3EqprjSXks3JVWCThtmPrpppZj3hYzBfmGCiSPo43S3cbEdCejDBbhB/TY=

dotnet_csproj:
  patch: true
  file: '**\*.csproj'
  version: '{version}'
  package_version: '{version}'
  assembly_version: '{version}'
  file_version: '{version}'
  informational_version: '{version}'

before_build:
  - cmd: dotnet restore ./Inshapardaz.Database.sln

build_script:
  - cmd: dotnet build -c Release
  - cmd: dotnet pack -c Release .\src\Inshapardaz.Database.Migrations\Inshapardaz.Database.Migrations.csproj /p:PackageVersion=%APPVEYOR_BUILD_VERSION%
  - cmd: dotnet run --project .\src\Inshapardaz.Database.Migrations.Runner\Inshapardaz.Database.Migrations.Runner.csproj -- -c "%ConnectionString%"